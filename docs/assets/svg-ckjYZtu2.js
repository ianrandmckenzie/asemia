let l=null,u=!1;async function v(){if(l)return l;try{return l=await(await fetch("/assets/rules.json")).json(),l}catch(t){return console.error("Failed to load rules.json:",t),null}}function c(t,n,r){var i,o;if(!((o=(i=l==null?void 0:l.shapes)==null?void 0:i[t])!=null&&o[n]))return console.warn(`SVG not found: ${t}/${n}/${r}`),null;const s=l.shapes[t][n],e=s.find(a=>a.shape_name===r);return e?e.svg:(console.warn(`Shape not found: ${r} in ${t}/${n}`),console.log("Available shapes:",s.map(a=>a.shape_name)),null)}function f(t){const n=t.match(/\/assets\/shapes\/([^/]+)\/([^/]+)\/([^.]+)\.svg/);if(!n)return console.warn("Invalid SVG path format:",t),null;const[,r,s,e]=n;return c(r,s,e)}function g(t,n,r,s,e=""){const i=c(n,r,s);if(!i)return!1;const o=document.createElement("div");o.innerHTML=i;const a=o.querySelector("svg");return a?(e&&a.setAttribute("class",e),t.innerHTML="",t.appendChild(a),!0):(console.error("Invalid SVG string:",i.substring(0,100)+"..."),!1)}function m(t,n,r=""){const s=f(n);if(!s)return!1;const e=document.createElement("div");e.innerHTML=s;const i=e.querySelector("svg");return i?(r&&i.setAttribute("class",r),t.innerHTML="",t.appendChild(i),!0):(console.error("Invalid SVG string:",s.substring(0,100)+"..."),!1)}function p(t,n,r,s=""){const e=c(t,n,r);if(!e)return null;const i=document.createElement("div");i.innerHTML=e;const o=i.querySelector("svg");return o?(s&&o.setAttribute("class",s),o.setAttribute("data-category",t),o.setAttribute("data-angle-key",n),o.setAttribute("data-shape-name",r),o):(console.error("Invalid SVG string:",e.substring(0,100)+"..."),null)}function S(t,n=""){const r=f(t);if(!r)return null;const s=document.createElement("div");s.innerHTML=r;const e=s.querySelector("svg");return e?(n&&e.setAttribute("class",n),e):(console.error("Invalid SVG string:",r.substring(0,100)+"..."),null)}async function d(){if(!u)try{await v(),u=!0,console.log("SVG system initialized with rules data"),document.querySelectorAll("img[data-svg-replace]").forEach(t=>{const n=t.getAttribute("data-svg-replace")||t.src,r=t.className,s=t.alt,e=S(n,r);e&&s&&e.setAttribute("aria-label",s),e&&t.parentNode.replaceChild(e,t)}),window.dispatchEvent(new CustomEvent("svgSystemReady"))}catch(t){console.error("Failed to initialize SVG system:",t)}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",d):d();function h(){return u&&l!==null}window.SVGUtils={loadRulesData:v,getSVGByPath:c,getSVGByFilePath:f,insertSVG:g,insertSVGByFilePath:m,createSVGElement:p,createSVGElementByFilePath:S,initSVGSystem:d,isReady:h};console.log("SVGUtils loaded and available on window.SVGUtils");
