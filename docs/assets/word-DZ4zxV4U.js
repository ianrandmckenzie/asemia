import{i as C,a as $}from"./components-DeKn5Xul.js";import"./svg-ckjYZtu2.js";import"./builder-BaRL6B5b.js";import{i as k,g as v,s as S,a as B,b as L,u as f,d as G}from"./mobile_controls-DF0OqE54.js";async function h(){console.log("Initializing word generator...");const r=document.getElementById("loading");r.innerHTML=`
    <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
    <p class="mt-4 text-gray-600 dark:text-gray-300">Loading builder core...</p>
  `;try{if(window.initBuilderCore)await window.initBuilderCore();else throw new Error("Builder core not available");r.innerHTML=`
      <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
      <p class="mt-4 text-gray-600 dark:text-gray-300">Loading archived forms...</p>
    `,await j(),m(),k("base","base"),g(v(),".word-grids-wrapper"),z()}catch(t){console.error("Failed to initialize word generator:",t),r.innerHTML=`
      <div class="text-red-500 text-xl mb-4">‚ö†Ô∏è</div>
      <p class="text-gray-600 dark:text-gray-300 mb-4">Failed to initialize word generator</p>
      <p class="text-gray-500 dark:text-gray-400 text-sm">Error: ${t.message}</p>
    `}}let u=[];async function j(){var r;try{let t;try{const e=await fetch("./archive/manifest.json");if(e.ok)t=(await e.json()).files,console.log(`üìã Loaded manifest with ${t.length} files`);else throw new Error("Manifest not found")}catch(e){console.warn("Could not load manifest, falling back to hardcoded list:",e),t=["apek.json","cam.json","cam_v2.json","pyraflare.json","phoenetic/A.json","phoenetic/B.json","phoenetic/C.json"]}const n=[];for(const e of t)try{console.log(`Attempting to load: ./archive/${e}`);const o=await fetch(`./archive/${e}`);if(o.ok){const s=await o.json();s.filename=e,n.push(s),console.log(`‚úÖ Loaded ${e}:`,((r=s.metadata)==null?void 0:r.name)||"Unknown")}else console.warn(`‚ùå Failed to load ${e}: ${o.status} ${o.statusText}`)}catch(o){console.warn(`‚ùå Error loading ${e}:`,o)}if(console.log(`Total compositions loaded: ${n.length}`),n.length===0)throw new Error("No compositions could be loaded");u=n,console.log(`üéâ Successfully loaded ${n.length} archived forms as source material`)}catch(t){throw console.error("Failed to load archived forms:",t),t}}function m(){const r=document.getElementById("loading"),t=document.getElementById("words-grid"),n=document.getElementById("words-container"),e=document.getElementById("wordCount"),o=parseInt((e==null?void 0:e.value)||6);r.classList.add("hidden"),t.classList.remove("hidden"),n.innerHTML="";for(let s=0;s<o;s++){const a=K(s);n.appendChild(a)}g(v()),console.log(`Generated ${o} random words`)}function K(r){const t=document.createElement("div");t.className="bg-white dark:bg-slate-800 rounded-lg shadow-md border border-gray-200 dark:border-slate-700 p-2 md:p-6";const n=Math.floor(Math.random()*4)+2,e=document.createElement("div");e.className="mb-4 text-center";const o=document.createElement("h3");o.className="text-lg font-semibold text-gray-900 dark:text-gray-100",o.textContent=`Word ${r+1}`;const s=document.createElement("div");s.className="text-sm text-gray-600 dark:text-gray-400 mt-1",s.textContent=`${n} form${n>1?"s":""}`,e.appendChild(o),e.appendChild(s),t.appendChild(e);const a=document.createElement("div");a.className="relative bg-gray-50 dark:bg-slate-900 rounded-lg p-4 flex items-center justify-center overflow-x-auto",a.style.minHeight="350px";const i=document.createElement("div");i.className="flex items-center justify-center word-forms-wrapper",i.style.gap="calc(0.3 * 8px)";for(let l=0;l<n;l++){const d=M();i.appendChild(d)}return a.appendChild(i),t.appendChild(a),t}function M(){var s,a;const r=u[Math.floor(Math.random()*u.length)],t=document.createElement("div");t.className="inline-block",t.style.width="150px",t.style.height="150px",t.style.overflow="hidden";const n=document.createElement("div");n.className="relative word-grids-wrapper",n.style.transform="scale(0.3)",n.style.transformOrigin="top left";const e=document.createElement("div");e.className="grid grid-cols-5 gap-0 z-10",e.style.width="500px",e.style.height="500px";const o=document.createElement("div");return o.className="absolute grid grid-cols-4 gap-0 z-0",o.style.width="400px",o.style.height="400px",o.style.top="50px",o.style.left="50px",x(e,25),x(o,16),n.appendChild(e),n.appendChild(o),t.appendChild(n),(s=r.grids)!=null&&s.serifs&&b(e,r.grids.serifs),(a=r.grids)!=null&&a.joins&&b(o,r.grids.joins),N(t,e),t}function N(r,t){const n=[!1,!1,!1,!1,!1];for(let l=0;l<25;l++){const d=t.children[l],c=l%5;d&&d.children.length>0&&(n[c]=!0)}let e=0;for(let l=0;l<5&&!n[l];l++)e++;let o=0;for(let l=4;l>=0&&!n[l];l--)o++;const s=50,a=e*s,i=o*s;a>0&&(r.style.marginLeft=`-${a}px`),i>0&&(r.style.marginRight=`-${i}px`),r.dataset.leftKern=a,r.dataset.rightKern=i,console.log(`Applied kerning: left=${e} cols (-${a}px), right=${o} cols (-${i}px)`)}function x(r,t){const n=G();for(let e=0;e<t;e++){const o=document.createElement("div");o.className=`w-[100px] h-[100px] relative word-grid-cell ${n}`,o.dataset.index=e,r.appendChild(o)}}function b(r,t){const n={};t.shapes.forEach(e=>{n[e.index]||(n[e.index]=[]),n[e.index].push(e)}),Object.keys(n).forEach(e=>{const o=r.children[e];if(!o)return;n[e].forEach((a,i)=>{var d,c,y;const l={category:a.category,angleKey:a.angleKey,shape:{shape_name:a.shapeName},imagePath:a.imagePath};if((y=(c=(d=window.rulesData)==null?void 0:d.shapes)==null?void 0:c[a.category])!=null&&y[a.angleKey]){const w=window.rulesData.shapes[a.category][a.angleKey].find(p=>p.shape_name===a.shapeName);if(w){l.shape=w;const p=i>0;W(o,l,p)}else console.warn("Shape not found in rulesData:",a.shapeName)}else console.warn("Category/angleKey not found in rulesData:",a.category,a.angleKey)})})}function W(r,t,n=!1){n||(r.innerHTML="");const e="absolute";let o=null;if(window.SVGUtils&&window.SVGUtils.createSVGElement&&(o=window.SVGUtils.createSVGElement(t.category,t.angleKey,t.shape.shape_name,e)),!o){console.warn("Could not create SVG for shape:",t);return}o.setAttribute("alt",t.shape.shape_name),window.applyPositioning?window.applyPositioning(o,t):(o.style.width="100%",o.style.height="100%",o.style.top="0",o.style.left="0"),r.appendChild(o)}function z(){const r=document.getElementById("sticky-subnav");if(!r){console.warn("Sticky subnav not found");return}window.innerWidth<768||r.classList.remove("hidden"),S(g),B(".word-grids-wrapper",g),F(),L(".word-grid-cell",f);const n=document.getElementById("generateBtn");n&&n.addEventListener("click",m);const e=document.getElementById("mobileGenerateBtn");e&&e.addEventListener("click",m)}const E={"7xl":.6,"6xl":.5,"5xl":.4,"4xl":.3,"3xl":.25,"2xl":.2,xl:.167,lg:.15,base:.133,sm:.117,xs:.1};function g(r){const t=E[r]||E["4xl"],n=document.querySelectorAll(".word-grids-wrapper"),e=document.querySelectorAll(".word-forms-wrapper"),o=500*t;n.forEach(a=>{if(a.style.transform=`scale(${t})`,a.parentElement){const i=a.parentElement;i.style.width=`${o}px`,i.style.height=`${o}px`;const l=parseFloat(i.dataset.leftKern||0),d=parseFloat(i.dataset.rightKern||0);l>0&&(i.style.marginLeft=`-${l*t}px`),d>0&&(i.style.marginRight=`-${d*t}px`)}});const s=`calc(${t} * 8px)`;e.forEach(a=>{a.style.gap=s}),console.log(`Size changed to ${r} (scale: ${t}, size: ${o}px, gap: ${s}) for ${n.length} forms`)}function F(){const r=document.getElementById("bordersToggle");if(!r){console.warn("Borders toggle not found");return}f(r.checked,".word-grid-cell"),r.addEventListener("change",t=>{f(t.target.checked,".word-grid-cell")})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",h):h();window.initWordGenerator=h;window.generateWords=m;C();$();
