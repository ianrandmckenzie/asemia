import"./builder-CDpQHjwi.js";/* empty css              */import"./storage-BmQUty4t.js";async function c(){console.log("Initializing archive...");const t=document.getElementById("loading");t.innerHTML=`
    <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
    <p class="mt-4 text-gray-600 dark:text-gray-300">Loading builder core...</p>
  `;try{if(window.initBuilderCore)await window.initBuilderCore();else throw new Error("Builder core not available");t.innerHTML=`
      <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
      <p class="mt-4 text-gray-600 dark:text-gray-300">Loading archived forms...</p>
    `,await b()}catch(a){console.error("Failed to initialize archive:",a),t.innerHTML=`
      <div class="text-red-500 text-xl mb-4">‚ö†Ô∏è</div>
      <p class="text-gray-600 dark:text-gray-300 mb-4">Failed to initialize archive</p>
      <p class="text-gray-500 dark:text-gray-400 text-sm">Error: ${a.message}</p>
    `}}async function b(){var n;const t=document.getElementById("loading");document.getElementById("error");const a=document.getElementById("archive-grid"),e=document.getElementById("archive-forms");try{let o;try{const r=await fetch("./archive/manifest.json");if(r.ok)o=(await r.json()).files,console.log(`üìã Loaded manifest with ${o.length} files`);else throw new Error("Manifest not found")}catch(r){console.warn("Could not load manifest, falling back to hardcoded list:",r),o=["cam.json","cam_v2.json","pyraflare.json","apek.json","phoenetic/A.json","phoenetic/B.json","phoenetic/C.json"]}const d=[];for(const r of o)try{console.log(`Attempting to load: ./archive/${r}`);const l=await fetch(`./archive/${r}`);if(l.ok){const s=await l.json();s.filename=r,d.push(s),console.log(`‚úÖ Loaded ${r}:`,((n=s.metadata)==null?void 0:n.name)||"Unknown")}else console.warn(`‚ùå Failed to load ${r}: ${l.status} ${l.statusText}`)}catch(l){console.warn(`‚ùå Error loading ${r}:`,l)}if(console.log(`Total compositions loaded: ${d.length}`),d.length===0)throw new Error("No compositions could be loaded");t.classList.add("hidden"),a.classList.remove("hidden"),e.innerHTML="",d.forEach((r,l)=>{var i;console.log(`Creating form element ${l+1}/${d.length}:`,(i=r.metadata)==null?void 0:i.name);const s=C(r);e.appendChild(s)}),console.log(`üéâ Successfully loaded ${d.length} archived forms`),L(),$()}catch(o){console.error("Failed to load archived forms:",o),t.classList.add("hidden"),S()}}function C(t){var g,h,p,u;const a=document.createElement("div");a.className="bg-white dark:bg-slate-800 rounded-lg shadow-md border border-gray-200 dark:border-slate-700 p-6";const e=document.createElement("div");e.className="mb-6";const n=document.createElement("h2");n.className="text-xl font-bold text-gray-900 dark:text-gray-100 mb-2",n.textContent=((g=t.metadata)==null?void 0:g.name)||"Untitled";const o=document.createElement("div");if(o.className="text-sm text-gray-600 dark:text-gray-400 flex flex-wrap gap-4",(h=t.metadata)!=null&&h.created){const E=new Date(t.metadata.created),y=document.createElement("span");y.textContent=`Created: ${E.toLocaleDateString()}`,o.appendChild(y)}const d=document.createElement("span");d.textContent=`File: ${t.filename}`,o.appendChild(d),e.appendChild(n),e.appendChild(o),a.appendChild(e);const r=document.createElement("div");r.className="relative bg-gray-50 dark:bg-slate-900 rounded-lg p-4 flex items-center justify-center",r.style.minHeight="400px";const l=document.createElement("div");l.className="relative archive-grids-wrapper",l.style.transform="scale(0.6)";const s=document.createElement("div");s.className="grid grid-cols-5 gap-0 z-10",s.style.width="500px",s.style.height="500px",s.id=`serifs-${t.filename.replace(".json","")}`;const i=document.createElement("div");return i.className="absolute grid grid-cols-4 gap-0 z-0",i.style.width="400px",i.style.height="400px",i.style.top="50px",i.style.left="50px",i.id=`joins-${t.filename.replace(".json","")}`,f(s,25),f(i,16),l.appendChild(s),l.appendChild(i),r.appendChild(l),a.appendChild(r),(p=t.grids)!=null&&p.serifs&&x(s,t.grids.serifs),(u=t.grids)!=null&&u.joins&&x(i,t.grids.joins),a}function f(t,a){for(let e=0;e<a;e++){const n=document.createElement("div");n.className="w-[100px] h-[100px] relative archive-grid-cell",n.dataset.index=e,t.appendChild(n)}}function x(t,a){a.shapes.forEach(e=>{var o,d,r;const n=t.children[e.index];if(n){const l={category:e.category,angleKey:e.angleKey,shape:{shape_name:e.shapeName},imagePath:e.imagePath};if((r=(d=(o=window.rulesData)==null?void 0:o.shapes)==null?void 0:d[e.category])!=null&&r[e.angleKey]){const s=window.rulesData.shapes[e.category][e.angleKey].find(i=>i.shape_name===e.shapeName);s?(l.shape=s,k(n,l)):(console.warn("Shape not found in rulesData:",e.shapeName),m(n,e.shapeName))}else console.warn("Category/angleKey not found in rulesData:",e.category,e.angleKey),m(n,e.shapeName)}})}function k(t,a){t.innerHTML="";const e="absolute";let n=null;if(window.SVGUtils&&window.SVGUtils.createSVGElement&&(n=window.SVGUtils.createSVGElement(a.category,a.angleKey,a.shape.shape_name,e)),!n){console.warn("Could not create SVG for shape:",a),m(t,a.shape.shape_name);return}n.setAttribute("alt",a.shape.shape_name),window.applyPositioning?window.applyPositioning(n,a):(n.style.width="100%",n.style.height="100%",n.style.top="0",n.style.left="0"),t.appendChild(n)}function m(t,a){const e=document.createElement("div");e.textContent=a.substring(0,4),e.className="absolute inset-0 flex items-center justify-center text-xs font-mono text-gray-600 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded",t.appendChild(e)}function S(){const t=document.getElementById("loading"),a=document.getElementById("error");t.classList.add("hidden"),a.classList.remove("hidden")}function L(){const t=document.getElementById("bordersToggle");if(!t){console.warn("Borders toggle not found");return}v(t.checked),t.addEventListener("change",a=>{v(a.target.checked)})}function v(t){const a=document.querySelectorAll(".archive-grid-cell");a.forEach(e=>{t?e.classList.add("border","border-gray-200","dark:border-gray-600","border-opacity-20"):e.classList.remove("border","border-gray-200","dark:border-gray-600","border-opacity-20")}),console.log(`Borders ${t?"enabled":"disabled"} for ${a.length} cells`)}function $(){const t=document.getElementById("sticky-subnav");if(!t){console.warn("Sticky subnav not found");return}t.classList.remove("hidden");const a=document.querySelectorAll(".size-tab");a.forEach(e=>{e.addEventListener("click",()=>{const n=e.dataset.size;a.forEach(o=>{o===e?o.className="size-tab px-3 py-2 text-sm font-medium rounded-md transition-colors bg-blue-500 text-white":o.className="size-tab px-3 py-2 text-sm font-medium rounded-md transition-colors text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-slate-700"}),j(n)})})}const w={"7xl":.6,"6xl":.5,"5xl":.4,"4xl":.3,"3xl":.25,"2xl":.2,xl:.167,lg:.15,base:.133,sm:.117,xs:.1};function j(t){const a=w[t]||w["7xl"],e=document.querySelectorAll(".archive-grids-wrapper");e.forEach(n=>{n.style.transform=`scale(${a})`}),console.log(`Size changed to ${t} (scale: ${a}) for ${e.length} forms`)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",c):c();window.initArchive=c;window.loadArchivedForms=b;
