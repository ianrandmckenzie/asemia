import{i as C,a as S}from"./components-BLXMPu97.js";import"./svg-ckjYZtu2.js";import"./builder-D23-A9aE.js";import{i as k,g as v,s as $,a as B,b as G,u as h}from"./mobile_controls-BkOJlejW.js";async function u(){console.log("Initializing sentence generator...");const o=document.getElementById("loading");o.innerHTML=`
    <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
    <p class="mt-4 text-gray-600 dark:text-gray-300">Loading builder core...</p>
  `;try{if(window.initBuilderCore)await window.initBuilderCore();else throw new Error("Builder core not available");o.innerHTML=`
      <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
      <p class="mt-4 text-gray-600 dark:text-gray-300">Loading archived forms...</p>
    `,await L(),p(),k("xs","xs"),g(v(),".sentence-grids-wrapper"),T()}catch(e){console.error("Failed to initialize sentence generator:",e),o.innerHTML=`
      <div class="text-red-500 text-xl mb-4">‚ö†Ô∏è</div>
      <p class="text-gray-600 dark:text-gray-300 mb-4">Failed to initialize sentence generator</p>
      <p class="text-gray-500 dark:text-gray-400 text-sm">Error: ${e.message}</p>
    `}}let y=[];async function L(){var o;try{let e;try{const t=await fetch("./archive/manifest.json");if(t.ok)e=(await t.json()).files,console.log(`üìã Loaded manifest with ${e.length} files`);else throw new Error("Manifest not found")}catch(t){console.warn("Could not load manifest, falling back to hardcoded list:",t),e=["apek.json","cam.json","cam_v2.json","pyraflare.json","phoenetic/A.json","phoenetic/B.json","phoenetic/C.json"]}const n=[];for(const t of e)try{console.log(`Attempting to load: ./archive/${t}`);const s=await fetch(`./archive/${t}`);if(s.ok){const l=await s.json();l.filename=t,n.push(l),console.log(`‚úÖ Loaded ${t}:`,((o=l.metadata)==null?void 0:o.name)||"Unknown")}else console.warn(`‚ùå Failed to load ${t}: ${s.status} ${s.statusText}`)}catch(s){console.warn(`‚ùå Error loading ${t}:`,s)}if(console.log(`Total compositions loaded: ${n.length}`),n.length===0)throw new Error("No compositions could be loaded");y=n,console.log(`üéâ Successfully loaded ${n.length} archived forms as source material`)}catch(e){throw console.error("Failed to load archived forms:",e),e}}function p(){const o=document.getElementById("loading"),e=document.getElementById("sentences-grid"),n=document.getElementById("sentences-container"),t=document.getElementById("sentenceCount"),s=parseInt((t==null?void 0:t.value)||3);o.classList.add("hidden"),e.classList.remove("hidden"),n.innerHTML="";for(let l=0;l<s;l++){const a=N(l);n.appendChild(a)}g(v()),console.log(`Generated ${s} random sentences`)}function N(o){const e=document.createElement("div");e.className="bg-white dark:bg-slate-800 rounded-lg shadow-md border border-gray-200 dark:border-slate-700 p-2 md:p-6";const n=Math.floor(Math.random()*5)+3,t=document.createElement("div");t.className="mb-4 text-center";const s=document.createElement("h3");s.className="text-lg font-semibold text-gray-900 dark:text-gray-100",s.textContent=`Sentence ${o+1}`;const l=document.createElement("div");l.className="text-sm text-gray-600 dark:text-gray-400 mt-1",l.textContent=`${n} word${n>1?"s":""}`,t.appendChild(s),t.appendChild(l),e.appendChild(t);const a=document.createElement("div");a.className="relative bg-gray-50 dark:bg-slate-900 rounded-lg p-4 flex items-center justify-center overflow-x-auto",a.style.minHeight="400px";const c=document.createElement("div");c.className="flex flex-wrap items-center justify-center sentence-words-wrapper",c.style.rowGap="calc(0.133 * 24px)";for(let r=0;r<n;r++){const i=M();if(c.appendChild(i),r<n-1){const d=j();c.appendChild(d)}}return a.appendChild(c),e.appendChild(a),e}function M(){const o=document.createElement("div");o.className="inline-flex items-center word-forms-wrapper";const e=Math.floor(Math.random()*4)+2;o.style.gap="calc(0.133 * 8px)";for(let n=0;n<e;n++){const t=K();o.appendChild(t)}return o}function j(){const o=document.createElement("div");o.className="inline-block word-space",o.style.width="66.5px",o.style.height="66.5px";const e=document.createElement("div");e.className="relative sentence-grids-wrapper",e.style.transform="scale(0.133)",e.style.transformOrigin="top left";const n=document.createElement("div");return n.className="grid grid-cols-5 gap-0 z-10",n.style.width="500px",n.style.height="500px",w(n,25),e.appendChild(n),o.appendChild(e),o.dataset.isSpace="true",o}function K(){var l,a;const o=y[Math.floor(Math.random()*y.length)],e=document.createElement("div");e.className="inline-block",e.style.width="66.5px",e.style.height="66.5px",e.style.overflow="hidden";const n=document.createElement("div");n.className="relative sentence-grids-wrapper",n.style.transform="scale(0.133)",n.style.transformOrigin="top left";const t=document.createElement("div");t.className="grid grid-cols-5 gap-0 z-10",t.style.width="500px",t.style.height="500px";const s=document.createElement("div");return s.className="absolute grid grid-cols-4 gap-0 z-0",s.style.width="400px",s.style.height="400px",s.style.top="50px",s.style.left="50px",w(t,25),w(s,16),n.appendChild(t),n.appendChild(s),e.appendChild(n),(l=o.grids)!=null&&l.serifs&&E(t,o.grids.serifs),(a=o.grids)!=null&&a.joins&&E(s,o.grids.joins),z(e,t),e}function z(o,e){const n=[!1,!1,!1,!1,!1];for(let r=0;r<25;r++){const i=e.children[r],d=r%5;i&&i.children.length>0&&(n[d]=!0)}let t=0;for(let r=0;r<5&&!n[r];r++)t++;let s=0;for(let r=4;r>=0&&!n[r];r--)s++;const l=50,a=t*l,c=s*l;a>0&&(o.style.marginLeft=`-${a}px`),c>0&&(o.style.marginRight=`-${c}px`),o.dataset.leftKern=a,o.dataset.rightKern=c}function w(o,e){for(let n=0;n<e;n++){const t=document.createElement("div");t.className="w-[100px] h-[100px] relative sentence-grid-cell border border-gray-200 dark:border-gray-600 border-opacity-20",t.dataset.index=n,o.appendChild(t)}}function E(o,e){const n={};e.shapes.forEach(t=>{n[t.index]||(n[t.index]=[]),n[t.index].push(t)}),Object.keys(n).forEach(t=>{const s=o.children[t];if(!s)return;n[t].forEach((a,c)=>{var i,d,m;const r={category:a.category,angleKey:a.angleKey,shape:{shape_name:a.shapeName},imagePath:a.imagePath};if((m=(d=(i=window.rulesData)==null?void 0:i.shapes)==null?void 0:d[a.category])!=null&&m[a.angleKey]){const x=window.rulesData.shapes[a.category][a.angleKey].find(f=>f.shape_name===a.shapeName);if(x){r.shape=x;const f=c>0;F(s,r,f)}else console.warn("Shape not found in rulesData:",a.shapeName)}else console.warn("Category/angleKey not found in rulesData:",a.category,a.angleKey)})})}function F(o,e,n=!1){n||(o.innerHTML="");const t="absolute";let s=null;if(window.SVGUtils&&window.SVGUtils.createSVGElement&&(s=window.SVGUtils.createSVGElement(e.category,e.angleKey,e.shape.shape_name,t)),!s){console.warn("Could not create SVG for shape:",e);return}s.setAttribute("alt",e.shape.shape_name),window.applyPositioning?window.applyPositioning(s,e):(s.style.width="100%",s.style.height="100%",s.style.top="0",s.style.left="0"),o.appendChild(s)}function T(){const o=document.getElementById("sticky-subnav");if(!o){console.warn("Sticky subnav not found");return}window.innerWidth<768||o.classList.remove("hidden"),$(g),B(".sentence-grids-wrapper",g),W(),G(".sentence-grid-cell",h);const n=document.getElementById("generateBtn");n&&n.addEventListener("click",p);const t=document.getElementById("mobileGenerateBtn");t&&t.addEventListener("click",p)}const b={"7xl":.6,"6xl":.5,"5xl":.4,"4xl":.3,"3xl":.25,"2xl":.2,xl:.167,lg:.15,base:.133,sm:.117,xs:.1};function g(o){const e=b[o]||b.base,n=document.querySelectorAll(".sentence-grids-wrapper"),t=document.querySelectorAll(".word-forms-wrapper"),s=document.querySelectorAll(".sentence-words-wrapper"),l=500*e;n.forEach(r=>{if(r.style.transform=`scale(${e})`,r.parentElement){const i=r.parentElement;if(i.style.width=`${l}px`,i.style.height=`${l}px`,!i.dataset.isSpace){const d=parseFloat(i.dataset.leftKern||0),m=parseFloat(i.dataset.rightKern||0);d>0&&(i.style.marginLeft=`-${d*e}px`),m>0&&(i.style.marginRight=`-${m*e}px`)}}});const a=`calc(${e} * 8px)`;t.forEach(r=>{r.style.gap=a});const c=`calc(${e} * 24px)`;s.forEach(r=>{r.style.rowGap=c}),console.log(`Size changed to ${o} (scale: ${e}, size: ${l}px) for ${n.length} forms`)}function W(){const o=document.getElementById("bordersToggle");if(!o){console.warn("Borders toggle not found");return}h(o.checked,".sentence-grid-cell"),o.addEventListener("change",e=>{h(e.target.checked,".sentence-grid-cell")})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",u):u();window.initSentenceGenerator=u;window.generateSentences=p;C();S();
