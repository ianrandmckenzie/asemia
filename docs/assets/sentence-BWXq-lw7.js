import{i as E,a as b}from"./components-DkINTHxm.js";import"./svg-ckjYZtu2.js";import"./builder-D23-A9aE.js";import{i as v,g as C,s as S,a as k,b as $,u as p}from"./mobile_controls-BkOJlejW.js";async function g(){console.log("Initializing sentence generator...");const o=document.getElementById("loading");o.innerHTML=`
    <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
    <p class="mt-4 text-gray-600 dark:text-gray-300">Loading builder core...</p>
  `;try{if(window.initBuilderCore)await window.initBuilderCore();else throw new Error("Builder core not available");o.innerHTML=`
      <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
      <p class="mt-4 text-gray-600 dark:text-gray-300">Loading archived forms...</p>
    `,await G(),m(),v("xs","xs"),u(C(),".sentence-grids-wrapper"),z()}catch(t){console.error("Failed to initialize sentence generator:",t),o.innerHTML=`
      <div class="text-red-500 text-xl mb-4">‚ö†Ô∏è</div>
      <p class="text-gray-600 dark:text-gray-300 mb-4">Failed to initialize sentence generator</p>
      <p class="text-gray-500 dark:text-gray-400 text-sm">Error: ${t.message}</p>
    `}}let f=[];async function G(){var o;try{let t;try{const n=await fetch("./archive/manifest.json");if(n.ok)t=(await n.json()).files,console.log(`üìã Loaded manifest with ${t.length} files`);else throw new Error("Manifest not found")}catch(n){console.warn("Could not load manifest, falling back to hardcoded list:",n),t=["apek.json","cam.json","cam_v2.json","pyraflare.json","phoenetic/A.json","phoenetic/B.json","phoenetic/C.json"]}const e=[];for(const n of t)try{console.log(`Attempting to load: ./archive/${n}`);const s=await fetch(`./archive/${n}`);if(s.ok){const r=await s.json();r.filename=n,e.push(r),console.log(`‚úÖ Loaded ${n}:`,((o=r.metadata)==null?void 0:o.name)||"Unknown")}else console.warn(`‚ùå Failed to load ${n}: ${s.status} ${s.statusText}`)}catch(s){console.warn(`‚ùå Error loading ${n}:`,s)}if(console.log(`Total compositions loaded: ${e.length}`),e.length===0)throw new Error("No compositions could be loaded");f=e,console.log(`üéâ Successfully loaded ${e.length} archived forms as source material`)}catch(t){throw console.error("Failed to load archived forms:",t),t}}function m(){const o=document.getElementById("loading"),t=document.getElementById("sentences-grid"),e=document.getElementById("sentences-container"),n=document.getElementById("sentenceCount"),s=parseInt((n==null?void 0:n.value)||3);o.classList.add("hidden"),t.classList.remove("hidden"),e.innerHTML="";for(let r=0;r<s;r++){const l=L(r);e.appendChild(l)}console.log(`Generated ${s} random sentences`)}function L(o){const t=document.createElement("div");t.className="bg-white dark:bg-slate-800 rounded-lg shadow-md border border-gray-200 dark:border-slate-700 p-2 md:p-6";const e=Math.floor(Math.random()*5)+3,n=document.createElement("div");n.className="mb-4 text-center";const s=document.createElement("h3");s.className="text-lg font-semibold text-gray-900 dark:text-gray-100",s.textContent=`Sentence ${o+1}`;const r=document.createElement("div");r.className="text-sm text-gray-600 dark:text-gray-400 mt-1",r.textContent=`${e} word${e>1?"s":""}`,n.appendChild(s),n.appendChild(r),t.appendChild(n);const l=document.createElement("div");l.className="relative bg-gray-50 dark:bg-slate-900 rounded-lg p-4 flex items-center justify-center overflow-x-auto",l.style.minHeight="400px";const i=document.createElement("div");i.className="flex flex-wrap items-center justify-center sentence-words-wrapper",i.style.rowGap="calc(0.133 * 24px)";for(let a=0;a<e;a++){const c=B();if(i.appendChild(c),a<e-1){const d=N();i.appendChild(d)}}return l.appendChild(i),t.appendChild(l),t}function B(){const o=document.createElement("div");o.className="inline-flex items-center word-forms-wrapper";const t=Math.floor(Math.random()*4)+2;o.style.gap="calc(0.133 * 8px)";for(let e=0;e<t;e++){const n=M();o.appendChild(n)}return o}function N(){const o=document.createElement("div");o.className="inline-block word-space",o.style.width="66.5px",o.style.height="66.5px";const t=document.createElement("div");t.className="relative sentence-grids-wrapper",t.style.transform="scale(0.133)",t.style.transformOrigin="top left";const e=document.createElement("div");return e.className="grid grid-cols-5 gap-0 z-10",e.style.width="500px",e.style.height="500px",h(e,25),t.appendChild(e),o.appendChild(t),o.dataset.isSpace="true",o}function M(){var r,l;const o=f[Math.floor(Math.random()*f.length)],t=document.createElement("div");t.className="inline-block",t.style.width="66.5px",t.style.height="66.5px",t.style.overflow="hidden";const e=document.createElement("div");e.className="relative sentence-grids-wrapper",e.style.transform="scale(0.133)",e.style.transformOrigin="top left";const n=document.createElement("div");n.className="grid grid-cols-5 gap-0 z-10",n.style.width="500px",n.style.height="500px";const s=document.createElement("div");return s.className="absolute grid grid-cols-4 gap-0 z-0",s.style.width="400px",s.style.height="400px",s.style.top="50px",s.style.left="50px",h(n,25),h(s,16),e.appendChild(n),e.appendChild(s),t.appendChild(e),(r=o.grids)!=null&&r.serifs&&w(n,o.grids.serifs),(l=o.grids)!=null&&l.joins&&w(s,o.grids.joins),K(t,n),t}function K(o,t){const e=[!1,!1,!1,!1,!1];for(let a=0;a<25;a++){const c=t.children[a],d=a%5;c&&c.children.length>0&&(e[d]=!0)}let n=0;for(let a=0;a<5&&!e[a];a++)n++;let s=0;for(let a=4;a>=0&&!e[a];a--)s++;const r=50,l=n*r,i=s*r;l>0&&(o.style.marginLeft=`-${l}px`),i>0&&(o.style.marginRight=`-${i}px`),o.dataset.leftKern=l,o.dataset.rightKern=i}function h(o,t){for(let e=0;e<t;e++){const n=document.createElement("div");n.className="w-[100px] h-[100px] relative sentence-grid-cell border border-gray-200 dark:border-gray-600 border-opacity-20",n.dataset.index=e,o.appendChild(n)}}function w(o,t){t.shapes.forEach(e=>{var s,r,l;const n=o.children[e.index];if(n){const i={category:e.category,angleKey:e.angleKey,shape:{shape_name:e.shapeName},imagePath:e.imagePath};if((l=(r=(s=window.rulesData)==null?void 0:s.shapes)==null?void 0:r[e.category])!=null&&l[e.angleKey]){const a=window.rulesData.shapes[e.category][e.angleKey].find(c=>c.shape_name===e.shapeName);a?(i.shape=a,j(n,i)):console.warn("Shape not found in rulesData:",e.shapeName)}else console.warn("Category/angleKey not found in rulesData:",e.category,e.angleKey)}})}function j(o,t){o.innerHTML="";const e="absolute";let n=null;if(window.SVGUtils&&window.SVGUtils.createSVGElement&&(n=window.SVGUtils.createSVGElement(t.category,t.angleKey,t.shape.shape_name,e)),!n){console.warn("Could not create SVG for shape:",t);return}n.setAttribute("alt",t.shape.shape_name),window.applyPositioning?window.applyPositioning(n,t):(n.style.width="100%",n.style.height="100%",n.style.top="0",n.style.left="0"),o.appendChild(n)}function z(){const o=document.getElementById("sticky-subnav");if(!o){console.warn("Sticky subnav not found");return}window.innerWidth<768||o.classList.remove("hidden"),S(u),k(".sentence-grids-wrapper",u),F(),$(".sentence-grid-cell",p);const e=document.getElementById("generateBtn");e&&e.addEventListener("click",m);const n=document.getElementById("mobileGenerateBtn");n&&n.addEventListener("click",m)}const x={"7xl":.6,"6xl":.5,"5xl":.4,"4xl":.3,"3xl":.25,"2xl":.2,xl:.167,lg:.15,base:.133,sm:.117,xs:.1};function u(o){const t=x[o]||x.base,e=document.querySelectorAll(".sentence-grids-wrapper"),n=document.querySelectorAll(".word-forms-wrapper"),s=document.querySelectorAll(".sentence-words-wrapper"),r=500*t;e.forEach(a=>{if(a.style.transform=`scale(${t})`,a.parentElement){const c=a.parentElement;if(c.style.width=`${r}px`,c.style.height=`${r}px`,!c.dataset.isSpace){const d=parseFloat(c.dataset.leftKern||0),y=parseFloat(c.dataset.rightKern||0);d>0&&(c.style.marginLeft=`-${d*t}px`),y>0&&(c.style.marginRight=`-${y*t}px`)}}});const l=`calc(${t} * 8px)`;n.forEach(a=>{a.style.gap=l});const i=`calc(${t} * 24px)`;s.forEach(a=>{a.style.rowGap=i}),console.log(`Size changed to ${o} (scale: ${t}, size: ${r}px) for ${e.length} forms`)}function F(){const o=document.getElementById("bordersToggle");if(!o){console.warn("Borders toggle not found");return}p(o.checked,".sentence-grid-cell"),o.addEventListener("change",t=>{p(t.target.checked,".sentence-grid-cell")})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",g):g();window.initSentenceGenerator=g;window.generateSentences=m;E();b();
