import{i as C,a as $}from"./components-DgBXf6kn.js";import"./svg-ckjYZtu2.js";import"./storage-CFRcmG0L.js";import{i as k,g as v,s as S,a as B,b as L,u as f,d as G}from"./mobile_controls-DF0OqE54.js";async function h(){console.log("Initializing word generator...");const r=document.getElementById("loading");r.innerHTML=`
    <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
    <p class="mt-4 text-gray-600 dark:text-gray-300">Loading builder core...</p>
  `;try{if(window.initBuilderCore)await window.initBuilderCore();else throw new Error("Builder core not available");r.innerHTML=`
      <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
      <p class="mt-4 text-gray-600 dark:text-gray-300">Loading archived forms...</p>
    `,await j(),m(),k("base","base"),g(v(),".word-grids-wrapper"),z()}catch(o){console.error("Failed to initialize word generator:",o),r.innerHTML=`
      <div class="text-red-500 text-xl mb-4">‚ö†Ô∏è</div>
      <p class="text-gray-600 dark:text-gray-300 mb-4">Failed to initialize word generator</p>
      <p class="text-gray-500 dark:text-gray-400 text-sm">Error: ${o.message}</p>
    `}}let u=[];async function j(){var r;try{const o=[];let n;try{const e=await fetch("./archive/manifest.json");if(e.ok)n=(await e.json()).files,console.log(`üìã Loaded manifest with ${n.length} files`);else throw new Error("Manifest not found")}catch(e){console.warn("Could not load manifest, falling back to hardcoded list:",e),n=["apek.json","cam.json","cam_v2.json","pyraflare.json","phoenetic/A.json","phoenetic/B.json","phoenetic/C.json"]}for(const e of n)try{console.log(`Attempting to load: ./archive/${e}`);const t=await fetch(`./archive/${e}`);if(t.ok){const a=await t.json();a.filename=e,a.source="archive",o.push(a),console.log(`‚úÖ Loaded ${e}:`,((r=a.metadata)==null?void 0:r.name)||"Unknown")}else console.warn(`‚ùå Failed to load ${e}: ${t.status} ${t.statusText}`)}catch(t){console.warn(`‚ùå Error loading ${e}:`,t)}console.log(`Total compositions loaded from archive: ${o.length}`);try{if(window.getAllCompositions){const e=await window.getAllCompositions();console.log(`üì¶ Found ${e.length} compositions in browser storage`),e.forEach(t=>{var a;t.source="browser",o.push(t),console.log("‚úÖ Loaded from browser:",((a=t.metadata)==null?void 0:a.name)||"Unknown")})}else console.warn("Browser storage not available (getAllCompositions function not found)")}catch(e){console.warn("Could not load compositions from browser storage:",e)}if(console.log(`Total compositions loaded: ${o.length} (archive + browser)`),o.length===0)throw new Error("No compositions could be loaded");u=o,console.log(`üéâ Successfully loaded ${o.length} forms as source material`)}catch(o){throw console.error("Failed to load archived forms:",o),o}}function m(){const r=document.getElementById("loading"),o=document.getElementById("words-grid"),n=document.getElementById("words-container"),e=document.getElementById("wordCount"),t=parseInt((e==null?void 0:e.value)||6);r.classList.add("hidden"),o.classList.remove("hidden"),n.innerHTML="";for(let a=0;a<t;a++){const s=K(a);n.appendChild(s)}g(v()),console.log(`Generated ${t} random words`)}function K(r){const o=document.createElement("div");o.className="bg-white dark:bg-slate-800 rounded-lg shadow-md border border-gray-200 dark:border-slate-700 p-2 md:p-6";const n=Math.floor(Math.random()*4)+2,e=document.createElement("div");e.className="mb-4 text-center";const t=document.createElement("h3");t.className="text-lg font-semibold text-gray-900 dark:text-gray-100",t.textContent=`Word ${r+1}`;const a=document.createElement("div");a.className="text-sm text-gray-600 dark:text-gray-400 mt-1",a.textContent=`${n} form${n>1?"s":""}`,e.appendChild(t),e.appendChild(a),o.appendChild(e);const s=document.createElement("div");s.className="relative bg-gray-50 dark:bg-slate-900 rounded-lg p-4 flex items-center justify-center overflow-x-auto",s.style.minHeight="350px";const i=document.createElement("div");i.className="flex items-center justify-center word-forms-wrapper",i.style.gap="calc(0.3 * 8px)";for(let l=0;l<n;l++){const d=M();i.appendChild(d)}return s.appendChild(i),o.appendChild(s),o}function M(){var a,s;const r=u[Math.floor(Math.random()*u.length)],o=document.createElement("div");o.className="inline-block",o.style.width="150px",o.style.height="150px",o.style.overflow="hidden";const n=document.createElement("div");n.className="relative word-grids-wrapper",n.style.transform="scale(0.3)",n.style.transformOrigin="top left";const e=document.createElement("div");e.className="grid grid-cols-5 gap-0 z-10",e.style.width="500px",e.style.height="500px";const t=document.createElement("div");return t.className="absolute grid grid-cols-4 gap-0 z-0",t.style.width="400px",t.style.height="400px",t.style.top="50px",t.style.left="50px",x(e,25),x(t,16),n.appendChild(e),n.appendChild(t),o.appendChild(n),(a=r.grids)!=null&&a.serifs&&b(e,r.grids.serifs),(s=r.grids)!=null&&s.joins&&b(t,r.grids.joins),N(o,e),o}function N(r,o){const n=[!1,!1,!1,!1,!1];for(let l=0;l<25;l++){const d=o.children[l],c=l%5;d&&d.children.length>0&&(n[c]=!0)}let e=0;for(let l=0;l<5&&!n[l];l++)e++;let t=0;for(let l=4;l>=0&&!n[l];l--)t++;const a=50,s=e*a,i=t*a;s>0&&(r.style.marginLeft=`-${s}px`),i>0&&(r.style.marginRight=`-${i}px`),r.dataset.leftKern=s,r.dataset.rightKern=i,console.log(`Applied kerning: left=${e} cols (-${s}px), right=${t} cols (-${i}px)`)}function x(r,o){const n=G();for(let e=0;e<o;e++){const t=document.createElement("div");t.className=`w-[100px] h-[100px] relative word-grid-cell ${n}`,t.dataset.index=e,r.appendChild(t)}}function b(r,o){const n={};o.shapes.forEach(e=>{n[e.index]||(n[e.index]=[]),n[e.index].push(e)}),Object.keys(n).forEach(e=>{const t=r.children[e];if(!t)return;n[e].forEach((s,i)=>{var d,c,w;const l={category:s.category,angleKey:s.angleKey,shape:{shape_name:s.shapeName},imagePath:s.imagePath};if((w=(c=(d=window.rulesData)==null?void 0:d.shapes)==null?void 0:c[s.category])!=null&&w[s.angleKey]){const y=window.rulesData.shapes[s.category][s.angleKey].find(p=>p.shape_name===s.shapeName);if(y){l.shape=y;const p=i>0;W(t,l,p)}else console.warn("Shape not found in rulesData:",s.shapeName)}else console.warn("Category/angleKey not found in rulesData:",s.category,s.angleKey)})})}function W(r,o,n=!1){n||(r.innerHTML="");const e="absolute";let t=null;if(window.SVGUtils&&window.SVGUtils.createSVGElement&&(t=window.SVGUtils.createSVGElement(o.category,o.angleKey,o.shape.shape_name,e)),!t){console.warn("Could not create SVG for shape:",o);return}t.setAttribute("alt",o.shape.shape_name),window.applyPositioning?window.applyPositioning(t,o):(t.style.width="100%",t.style.height="100%",t.style.top="0",t.style.left="0"),r.appendChild(t)}function z(){const r=document.getElementById("sticky-subnav");if(!r){console.warn("Sticky subnav not found");return}window.innerWidth<768||r.classList.remove("hidden"),S(g),B(".word-grids-wrapper",g),F(),L(".word-grid-cell",f);const n=document.getElementById("generateBtn");n&&n.addEventListener("click",m);const e=document.getElementById("mobileGenerateBtn");e&&e.addEventListener("click",m)}const E={"7xl":.6,"6xl":.5,"5xl":.4,"4xl":.3,"3xl":.25,"2xl":.2,xl:.167,lg:.15,base:.133,sm:.117,xs:.1};function g(r){const o=E[r]||E["4xl"],n=document.querySelectorAll(".word-grids-wrapper"),e=document.querySelectorAll(".word-forms-wrapper"),t=500*o;n.forEach(s=>{if(s.style.transform=`scale(${o})`,s.parentElement){const i=s.parentElement;i.style.width=`${t}px`,i.style.height=`${t}px`;const l=parseFloat(i.dataset.leftKern||0),d=parseFloat(i.dataset.rightKern||0);l>0&&(i.style.marginLeft=`-${l*o}px`),d>0&&(i.style.marginRight=`-${d*o}px`)}});const a=`calc(${o} * 8px)`;e.forEach(s=>{s.style.gap=a}),console.log(`Size changed to ${r} (scale: ${o}, size: ${t}px, gap: ${a}) for ${n.length} forms`)}function F(){const r=document.getElementById("bordersToggle");if(!r){console.warn("Borders toggle not found");return}f(r.checked,".word-grid-cell"),r.addEventListener("change",o=>{f(o.target.checked,".word-grid-cell")})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",h):h();window.initWordGenerator=h;window.generateWords=m;C();$();
