import{i as C,a as S}from"./components-BnrkmWez.js";import"./svg-ckjYZtu2.js";import"./storage-Vn0rREE0.js";import{i as k,g as v,s as $,a as B,b as G,u as h,d as L}from"./mobile_controls-DF0OqE54.js";async function u(){console.log("Initializing sentence generator...");const t=document.getElementById("loading");t.innerHTML=`
    <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
    <p class="mt-4 text-gray-600 dark:text-gray-300">Loading builder core...</p>
  `;try{if(window.initBuilderCore)await window.initBuilderCore();else throw new Error("Builder core not available");t.innerHTML=`
      <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
      <p class="mt-4 text-gray-600 dark:text-gray-300">Loading archived forms...</p>
    `,await N(),m(),k("xs","xs"),g(v(),".sentence-grids-wrapper"),A()}catch(n){console.error("Failed to initialize sentence generator:",n),t.innerHTML=`
      <div class="inline-block w-12 h-12 mb-4">
        <img src="assets/icons/warning.svg" alt="Warning" class="w-full h-full text-red-500">
      </div>
      <p class="text-gray-600 dark:text-gray-300 mb-4">Failed to initialize sentence generator</p>
      <p class="text-gray-500 dark:text-gray-400 text-sm">Error: ${n.message}</p>
    `}}let y=[];async function N(){try{const t=[];let n;try{const e=await fetch("./archive/manifest.json");if(e.ok)n=(await e.json()).files;else throw new Error("Manifest not found")}catch(e){console.warn("Could not load manifest, falling back to hardcoded list:",e),n=["apek.json","cam.json","cam_v2.json","pyraflare.json","phoenetic/A.json","phoenetic/B.json","phoenetic/C.json"]}for(const e of n)try{console.log(`Attempting to load: ./archive/${e}`);const o=await fetch(`./archive/${e}`);if(o.ok){const s=await o.json();s.filename=e,s.source="archive",t.push(s)}else console.warn(`[FAILED] Failed to load ${e}: ${o.status} ${o.statusText}`)}catch(o){console.warn(`[ERROR] Error loading ${e}:`,o)}console.log(`Total compositions loaded from archive: ${t.length}`);try{window.getAllCompositions?(await window.getAllCompositions()).forEach(o=>{o.source="browser",t.push(o)}):console.warn("Browser storage not available (getAllCompositions function not found)")}catch(e){console.warn("Could not load compositions from browser storage:",e)}if(console.log(`Total compositions loaded: ${t.length} (archive + browser)`),t.length===0)throw new Error("No compositions could be loaded");y=t}catch(t){throw console.error("Failed to load archived forms:",t),t}}function m(){const t=document.getElementById("loading"),n=document.getElementById("sentences-grid"),e=document.getElementById("sentences-container"),o=document.getElementById("sentenceCount"),s=parseInt((o==null?void 0:o.value)||3);t.classList.add("hidden"),n.classList.remove("hidden"),e.innerHTML="";for(let l=0;l<s;l++){const r=M(l);e.appendChild(r)}g(v()),console.log(`Generated ${s} random sentences`)}function M(t){const n=document.createElement("div");n.className="bg-white dark:bg-slate-800 rounded-lg shadow-md border border-gray-200 dark:border-slate-700 p-2 md:p-6";const e=Math.floor(Math.random()*5)+3,o=document.createElement("div");o.className="mb-4 text-center";const s=document.createElement("h3");s.className="text-lg font-semibold text-gray-900 dark:text-gray-100",s.textContent=`Sentence ${t+1}`;const l=document.createElement("div");l.className="text-sm text-gray-600 dark:text-gray-400 mt-1",l.textContent=`${e} word${e>1?"s":""}`,o.appendChild(s),o.appendChild(l),n.appendChild(o);const r=document.createElement("div");r.className="relative bg-gray-50 dark:bg-slate-900 rounded-lg p-4 flex items-center justify-center overflow-x-auto",r.style.minHeight="400px";const c=document.createElement("div");c.className="flex flex-wrap items-center justify-center sentence-words-wrapper",c.style.rowGap="calc(0.133 * 24px)";for(let a=0;a<e;a++){const i=j();if(c.appendChild(i),a<e-1){const d=K();c.appendChild(d)}}return r.appendChild(c),n.appendChild(r),n}function j(){const t=document.createElement("div");t.className="inline-flex items-center word-forms-wrapper";const n=Math.floor(Math.random()*4)+2;t.style.gap="calc(0.133 * 8px)";for(let e=0;e<n;e++){const o=z();t.appendChild(o)}return t}function K(){const t=document.createElement("div");t.className="inline-block word-space",t.style.width="66.5px",t.style.height="66.5px";const n=document.createElement("div");n.className="relative sentence-grids-wrapper",n.style.transform="scale(0.133)",n.style.transformOrigin="top left";const e=document.createElement("div");return e.className="grid grid-cols-5 gap-0 z-10",e.style.width="500px",e.style.height="500px",w(e,25),n.appendChild(e),t.appendChild(n),t.dataset.isSpace="true",t}function z(){var l,r;const t=y[Math.floor(Math.random()*y.length)],n=document.createElement("div");n.className="inline-block",n.style.width="66.5px",n.style.height="66.5px",n.style.overflow="hidden";const e=document.createElement("div");e.className="relative sentence-grids-wrapper",e.style.transform="scale(0.133)",e.style.transformOrigin="top left";const o=document.createElement("div");o.className="grid grid-cols-5 gap-0 z-10",o.style.width="500px",o.style.height="500px";const s=document.createElement("div");return s.className="absolute grid grid-cols-4 gap-0 z-0",s.style.width="400px",s.style.height="400px",s.style.top="50px",s.style.left="50px",w(o,25),w(s,16),e.appendChild(o),e.appendChild(s),n.appendChild(e),(l=t.grids)!=null&&l.serifs&&E(o,t.grids.serifs),(r=t.grids)!=null&&r.joins&&E(s,t.grids.joins),F(n,o),n}function F(t,n){const e=[!1,!1,!1,!1,!1];for(let a=0;a<25;a++){const i=n.children[a],d=a%5;i&&i.children.length>0&&(e[d]=!0)}let o=0;for(let a=0;a<5&&!e[a];a++)o++;let s=0;for(let a=4;a>=0&&!e[a];a--)s++;const l=50,r=o*l,c=s*l;r>0&&(t.style.marginLeft=`-${r}px`),c>0&&(t.style.marginRight=`-${c}px`),t.dataset.leftKern=r,t.dataset.rightKern=c}function w(t,n){const e=L();for(let o=0;o<n;o++){const s=document.createElement("div");s.className=`w-[100px] h-[100px] relative sentence-grid-cell ${e}`,s.dataset.index=o,t.appendChild(s)}}function E(t,n){const e={};n.shapes.forEach(o=>{e[o.index]||(e[o.index]=[]),e[o.index].push(o)}),Object.keys(e).forEach(o=>{const s=t.children[o];if(!s)return;e[o].forEach((r,c)=>{var i,d,p;const a={category:r.category,angleKey:r.angleKey,shape:{shape_name:r.shapeName},imagePath:r.imagePath};if((p=(d=(i=window.rulesData)==null?void 0:i.shapes)==null?void 0:d[r.category])!=null&&p[r.angleKey]){const x=window.rulesData.shapes[r.category][r.angleKey].find(f=>f.shape_name===r.shapeName);if(x){a.shape=x;const f=c>0;T(s,a,f)}else console.warn("Shape not found in rulesData:",r.shapeName)}else console.warn("Category/angleKey not found in rulesData:",r.category,r.angleKey)})})}function T(t,n,e=!1){e||(t.innerHTML="");const o="absolute";let s=null;if(window.SVGUtils&&window.SVGUtils.createSVGElement&&(s=window.SVGUtils.createSVGElement(n.category,n.angleKey,n.shape.shape_name,o)),!s){console.warn("Could not create SVG for shape:",n);return}s.setAttribute("alt",n.shape.shape_name),window.applyPositioning?window.applyPositioning(s,n):(s.style.width="100%",s.style.height="100%",s.style.top="0",s.style.left="0"),t.appendChild(s)}function A(){const t=document.getElementById("sticky-subnav");if(!t){console.warn("Sticky subnav not found");return}window.innerWidth<768||t.classList.remove("hidden"),$(g),B(".sentence-grids-wrapper",g),W(),G(".sentence-grid-cell",h);const e=document.getElementById("generateBtn");e&&e.addEventListener("click",m);const o=document.getElementById("mobileGenerateBtn");o&&o.addEventListener("click",m)}const b={"7xl":.6,"6xl":.5,"5xl":.4,"4xl":.3,"3xl":.25,"2xl":.2,xl:.167,lg:.15,base:.133,sm:.117,xs:.1};function g(t){const n=b[t]||b.base,e=document.querySelectorAll(".sentence-grids-wrapper"),o=document.querySelectorAll(".word-forms-wrapper"),s=document.querySelectorAll(".sentence-words-wrapper"),l=500*n;e.forEach(a=>{if(a.style.transform=`scale(${n})`,a.parentElement){const i=a.parentElement;if(i.style.width=`${l}px`,i.style.height=`${l}px`,!i.dataset.isSpace){const d=parseFloat(i.dataset.leftKern||0),p=parseFloat(i.dataset.rightKern||0);d>0&&(i.style.marginLeft=`-${d*n}px`),p>0&&(i.style.marginRight=`-${p*n}px`)}}});const r=`calc(${n} * 8px)`;o.forEach(a=>{a.style.gap=r});const c=`calc(${n} * 24px)`;s.forEach(a=>{a.style.rowGap=c}),console.log(`Size changed to ${t} (scale: ${n}, size: ${l}px) for ${e.length} forms`)}function W(){const t=document.getElementById("bordersToggle");if(!t){console.warn("Borders toggle not found");return}h(t.checked,".sentence-grid-cell"),t.addEventListener("change",n=>{h(n.target.checked,".sentence-grid-cell")})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",u):u();window.initSentenceGenerator=u;window.generateSentences=m;C();S();
