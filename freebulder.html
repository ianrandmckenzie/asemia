<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <!-- Security Headers -->
  <meta http-equiv="X-Content-Type-Options" content="nosniff" />
  <meta http-equiv="X-XSS-Protection" content="1; mode=block" />
  <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin" />
  <meta http-equiv="Permissions-Policy" content="camera=(), microphone=(), geolocation=(), payment=()" />

  <meta name="description" content="" />
  <meta name="keywords" content="todo" />
  <title></title>
  <meta name="robots" content="index, follow">
  <meta name="language" content="en">

  <!-- Favicon and Icons -->
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/png" href="/favicon.png" />
  <link rel="shortcut icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />

  <!-- Open Graph Meta Tags for Social Sharing -->
  <meta property="og:title" content="">
  <meta property="og:description" content="">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://asemia.relentlesscurious.com">
  <meta property="og:image" content="https://asemia.relentlesscurious.com/og-image.jpeg">
  <meta property="og:site_name" content="">
  <meta property="og:locale" content="en_US">

  <!-- Twitter Card Meta Tags -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="">
  <meta name="twitter:description" content="">
  <meta name="twitter:image" content="https://asemia.relentlesscurious.com/og-image.jpeg">
  <meta property="twitter:domain" content="asemia.relentlesscurious.com">
  <meta property="twitter:url" content="https://asemia.relentlesscurious.com/">

  <!-- Canonical URL -->
  <link rel="canonical" href="https://asemia.relentlesscurious.com/">

  <link href="/src/style.css" rel="stylesheet" />
</head>
<body class="bg-white dark:bg-slate-900">
  <div class="flex flex-col md:flex-row h-[calc(85vh)] md:h-[calc(100vh-4rem)] text-black dark:text-white">
    <!-- Mobile Top Tabs (visible below md breakpoint) -->
    <div class="md:hidden flex flex-col bg-gray-100 dark:bg-slate-800 border-b border-gray-300 dark:border-gray-700">
      <!-- Tab Buttons -->
      <div class="flex border-b border-gray-300 dark:border-gray-700">
        <button id="mobileSerifTab" class="mobile-tab flex-1 pb-1 pt-2 border-r border-gray-300 dark:border-gray-700 bg-gray-200 dark:bg-slate-800" data-category="serifs">
          <div class="flex flex-col items-center gap-1">
            <svg class="h-6 w-auto" fill="currentColor" stroke="currentColor" stop-color="currentColor" width="100px" height="100px" viewBox="0 0 99.999999 100" version="1.1" id="svg1" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><defs id="defs1" /><g id="g1"><rect style="stroke-width:0.0487215" id="rect3-4" width="9.9512787" height="119.95128" x="45.024361" y="-19.975639" /><path d="M 45.25,51.936182 V 100 h -45 C 20.70912,98.219833 31.98881,86.542207 38.13672,74.875959 43.07144,65.511871 44.72077,56.184537 45.25,51.936182 Z" style="baseline-shift:baseline;display:inline;overflow:visible;vector-effect:none;stroke:none;stroke-width:0.24156;enable-background:accumulate;" id="path16" /><path d="M 54.75,51.93619 V 100 h 45 C 79.290883,98.21984 68.011192,86.54221 61.863277,74.87597 56.928563,65.51188 55.279226,56.18454 54.75,51.93619 Z" style="baseline-shift:baseline;display:inline;overflow:visible;vector-effect:none;stroke:none;stroke-width:0.24156;enable-background:accumulate;" id="path16-9" /></g></svg>
            <span class="text-xs font-medium">Serifs</span>
          </div>
        </button>
        <button id="mobileBodiesTab" class="mobile-tab flex-1 pb-1 pt-2 border-r border-gray-300 dark:border-gray-700 bg-gray-200 dark:bg-slate-800" data-category="bodies">
          <div class="flex flex-col items-center gap-1">
            <svg class="h-6 w-auto" fill="currentColor" stroke="currentColor" stop-color="currentColor" width="120px" height="100px" viewBox="0 0 120 100" version="1.1" id="svg1" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><defs id="defs1" /><rect style="stroke-width:0.0487215" id="rect3-4-4" width="9.9512787" height="119.95128" x="-54.975639" y="0.024369435" transform="rotate(-90)" /></svg>
            <span class="text-xs font-medium">Bodies</span>
          </div>
        </button>
        <button id="mobileJoinsTab" class="mobile-tab flex-1 pb-1 pt-2 border-r border-gray-300 dark:border-gray-700 bg-gray-200 dark:bg-slate-800" data-category="joins">
          <div class="flex flex-col items-center gap-1">
            <svg class="h-6 w-auto" fill="currentColor" stroke="currentColor" stop-color="currentColor" width="120px" height="120px" viewBox="0 0 120 120" version="1.1" id="svg1" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><defs id="defs1" /><g id="layer1" transform="translate(14.965794,194.55533)">  <g id="g2" transform="matrix(-1,0,0,1,105.02706,-194.56238)">  <path d="m 17.002063,110.02429 -9.9513306,9.95133 H 119.97562 v -9.95133 z" style="stroke-width:0.0487215" id="path5-5" />  <path d="M 102.99145,24 16.75,110.2415 h 99.99999 c -1.647,-0.26692 -3.39773,-0.58604 -5.25403,-1.00192 -8.67273,-1.943 -19.109025,-5.67969 -26.125479,-12.977215 C 78.354036,88.964904 74.861163,78.068631 80.076827,62.21273 83.500708,51.803975 90.677509,39.217883 102.99145,24 Z" id="path1-2" style="stroke-width:0.476189" />  <path d="M 17.002063,110.02429 H 2.949174 l -2.92488608,2.92489 v 7.02644 H 7.0507324 Z" style="stroke-width:0.0628574" id="path4-2" />  <path d="M 127.17518,-14.201717 2.949174,110.02429 H 17.002063 L 134.20163,-7.1752726 Z" style="stroke-width:0.0628574" id="path3-2" />  </g></g></svg>
            <span class="text-xs font-medium">Joins</span>
          </div>
        </button>
        <button id="mobileTexturesTab" class="mobile-tab flex-1 pb-1 pt-2 bg-gray-200 dark:bg-slate-800" data-category="textures">
          <div class="flex flex-col items-center gap-1">
            <svg class="h-6 w-auto" fill="currentColor" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
              <rect width="40" height="40" x="0" y="0" opacity="0.8"/>
              <rect width="40" height="40" x="60" y="0" opacity="0.5"/>
              <rect width="40" height="40" x="0" y="60" opacity="0.3"/>
              <rect width="40" height="40" x="60" y="60" opacity="0.9"/>
            </svg>
            <span class="text-xs font-medium">Textures</span>
          </div>
        </button>
      </div>

      <!-- Horizontal Scrollable Shape Selector -->
      <div id="mobileShapeSelectorWrapper" class="mobile-shape-selector-wrapper bg-white dark:bg-slate-900 border-b border-gray-300 dark:border-gray-700 py-0 hidden">
        <div id="mobileSerifShapes" class="mobile-shape-selector px-3 py-3 hidden" data-category="serifs"></div>
        <div id="mobileBodiesShapes" class="mobile-shape-selector hidden px-3 py-3" data-category="bodies"></div>
        <div id="mobileJoinsShapes" class="mobile-shape-selector hidden px-3 py-3" data-category="joins"></div>
        <div id="mobileTexturesShapes" class="mobile-shape-selector hidden px-3 py-3" data-category="textures"></div>
      </div>
    </div>

    <!-- Desktop Sidebar (visible at md breakpoint and above) -->
    <div id="sidebar" class="hidden md:flex md:w-80 bg-gray-100 dark:bg-slate-800 border-r border-gray-300 dark:border-gray-700 flex-col">
      <!-- Tabs -->
      <div class="flex border-b border-gray-300 dark:border-gray-700">
        <button id="bodiesTab" class="flex-1 py-3 px-4 bg-white dark:bg-slate-800 border-r border-gray-300 dark:border-gray-700 font-medium text-gray-900 dark:text-gray-100">
          Bodies/Serifs
        </button>
        <button id="joinsTab" class="flex-1 py-3 px-4 bg-gray-200 dark:bg-slate-700 border-r border-gray-300 dark:border-gray-700 font-medium text-gray-700 dark:text-gray-200">
          Joins
        </button>
        <button id="texturesTab" class="flex-1 py-3 px-4 bg-gray-200 dark:bg-slate-700 font-medium text-gray-700 dark:text-gray-200">
          Textures
        </button>
      </div>

      <!-- Content Area -->
      <div class="flex-1 overflow-y-auto p-4">
        <!-- Selected Shape Display -->
        <div id="selectedShapeDisplay" class="mb-4 p-3 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-gray-700 rounded hidden">
          <div class="text-sm font-medium text-slate-900 dark:text-gray-100">Selected Shape:</div>
          <div id="selectedShapeInfo" class="text-sm text-slate-700 dark:text-gray-300"></div>
          <button id="clearSelection" class="mt-2 px-2 py-1 bg-slate-500 dark:bg-slate-600 text-white text-xs rounded hover:bg-slate-600 dark:hover:bg-slate-500">
            Clear Selection
          </button>
        </div>

        <!-- Bodies/Serifs Content -->
        <div id="bodiesContent" class="space-y-4">
          <div class="space-y-2">
            <div class="flex items-center justify-between mb-2">
              <h3 class="font-serif font-semibold text-sm text-gray-700 dark:text-gray-200">Bodies</h3>
              <button id="bodiesEraseBtn" class="w-12 h-12 border border-gray-300 dark:border-gray-700 rounded hover:border-red-500 dark:hover:border-red-400 hover:bg-red-50 dark:hover:bg-red-900/40 flex items-center justify-center relative shape-button">
                <img src="/assets/icons/erase.svg" alt="Erase Bodies" class="w-6 h-6 dark:invert">
              </button>
            </div>
            <div id="bodiesShapes" class="grid grid-cols-4 gap-2"></div>
          </div>
          <div class="space-y-2">
            <div class="flex items-center justify-between mb-2">
              <h3 class="font-serif font-semibold text-sm text-gray-700 dark:text-gray-200">Serifs</h3>
              <button id="serifsEraseBtn" class="w-12 h-12 border border-gray-300 dark:border-gray-700 rounded hover:border-red-500 dark:hover:border-red-400 hover:bg-red-50 dark:hover:bg-red-900/40 flex items-center justify-center relative shape-button">
                <img src="/assets/icons/erase.svg" alt="Erase Serifs" class="w-6 h-6 dark:invert">
              </button>
            </div>
            <div id="serifsShapes" class="grid grid-cols-4 gap-2"></div>
          </div>
        </div>

        <!-- Joins Content -->
        <div id="joinsContent" class="hidden space-y-4">
          <div class="space-y-2">
            <div class="flex items-center justify-between mb-2">
              <h3 class="font-serif font-semibold text-sm text-gray-700 dark:text-gray-200">Joins</h3>
              <button id="joinsEraseBtn" class="w-12 h-12 border border-gray-300 dark:border-gray-700 rounded hover:border-red-500 dark:hover:border-red-400 hover:bg-red-50 dark:hover:bg-red-900/40 flex items-center justify-center relative shape-button">
                <img src="/assets/icons/erase.svg" alt="Erase Joins" class="w-6 h-6 dark:invert">
              </button>
            </div>
            <div id="joinsShapes" class="grid grid-cols-4 gap-2"></div>
          </div>
        </div>

        <!-- Textures Content -->
        <div id="texturesContent" class="hidden space-y-4">
          <div class="space-y-2">
            <h3 class="font-serif font-semibold text-sm text-gray-700 dark:text-gray-200">Textures</h3>
            <div id="texturesShapes" class="grid grid-cols-2 gap-2"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Main Content Area -->
    <div class="flex-1 relative bg-gray-50 dark:bg-slate-900">
      <!-- Desktop Controls (visible md and above) -->
      <div class="hidden md:flex absolute top-4 left-4 z-50 gap-2">
        <!-- Storage Dropdown -->
        <div class="relative group">
          <button class="flex items-center space-x-2 bg-white dark:bg-slate-800 hover:bg-gray-50 dark:hover:bg-slate-700 px-3 py-2 rounded-lg shadow-md border border-gray-300 dark:border-gray-700 transition-colors text-sm">
            <img src="/assets/icons/save-menu.svg" alt="Storage" class="h-4 w-4 dark:invert">
            <span>Storage</span>
            <svg class="h-3 w-3 ml-1" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path>
            </svg>
          </button>
          <!-- Dropdown Menu -->
          <div class="absolute left-0 top-full mt-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-gray-700 rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 min-w-[200px]">
            <button onclick="saveComposition()" class="flex items-center space-x-2 w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-t-lg">
              <img src="/assets/icons/save.svg" alt="Save to browser" class="h-4 w-4 dark:invert">
              <span>Save to browser</span>
            </button>
            <button onclick="saveCompositionToComputer()" class="flex items-center space-x-2 w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-700 border-t border-gray-200 dark:border-gray-600">
              <img src="/assets/icons/save-computer.svg" alt="Save to computer" class="h-4 w-4 dark:invert">
              <span>Save to computer</span>
            </button>
            <button onclick="loadFromBrowser()" class="flex items-center space-x-2 w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-700 border-t border-gray-200 dark:border-gray-600">
              <img src="/assets/icons/load.svg" alt="Load from browser" class="h-4 w-4 dark:invert">
              <span>Load from browser</span>
            </button>
            <button onclick="loadComposition()" class="flex items-center space-x-2 w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-700 border-t border-gray-200 dark:border-gray-600">
              <img src="/assets/icons/load-computer.svg" alt="Load from computer" class="h-4 w-4 dark:invert">
              <span>Load from computer</span>
            </button>
            <button onclick="manageCompositions()" class="flex items-center space-x-2 w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-b-lg border-t border-gray-200 dark:border-gray-600">
              <img src="/assets/icons/manage.svg" alt="Manage" class="h-4 w-4 dark:invert">
              <span>Manage</span>
            </button>
          </div>
        </div>

        <!-- Export Dropdown -->
        <div class="relative group">
          <button class="flex items-center space-x-2 bg-white dark:bg-slate-800 hover:bg-gray-50 dark:hover:bg-slate-700 px-3 py-2 rounded-lg shadow-md border border-gray-300 dark:border-gray-700 transition-colors text-sm">
            <img src="/assets/icons/export.svg" alt="Export" class="h-4 w-4 dark:invert">
            <span>Export</span>
            <svg class="h-3 w-3 ml-1" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path>
            </svg>
          </button>
          <!-- Dropdown Menu -->
          <div class="absolute left-0 top-full mt-1 bg-white dark:bg-slate-800 border border-gray-300 dark:border-gray-700 rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 min-w-[200px]">
            <button onclick="exportAsPNG()" class="flex items-center space-x-2 w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-t-lg">
              <img src="/assets/icons/png.svg" alt="Export PNG" class="h-4 w-4 dark:invert">
              <span>Export as PNG</span>
            </button>
            <button onclick="exportAsJPEG()" class="flex items-center space-x-2 w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-700 border-t border-gray-200 dark:border-gray-600">
              <img src="/assets/icons/image.svg" alt="Export JPEG" class="h-4 w-4 dark:invert">
              <span>Export as JPEG</span>
            </button>
            <button onclick="exportAsSVG()" class="flex items-center space-x-2 w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-b-lg border-t border-gray-200 dark:border-gray-600">
              <img src="/assets/icons/vector.svg" alt="Export SVG" class="h-4 w-4 dark:invert">
              <span>Export as SVG</span>
            </button>
          </div>
        </div>

        <!-- Clear Grids Button -->
        <button onclick="clearAllGrids()" class="flex items-center space-x-2 bg-white dark:bg-slate-800 hover:bg-red-50 dark:hover:bg-red-900/30 px-3 py-2 rounded-lg shadow-md border border-gray-300 dark:border-gray-700 transition-colors text-sm">
          <img src="/assets/icons/clear.svg" alt="Clear" class="h-4 w-4 dark:invert">
          <span class="text-gray-700 dark:text-gray-200">Clear Grids</span>
        </button>
      </div>

      <!-- Desktop Controls (visible md and above) -->
      <div class="hidden md:flex absolute top-4 right-4 z-50 gap-2">
        <!-- Preview Toggle -->
        <button id="desktopPreviewBtn" class="flex items-center space-x-2 bg-white dark:bg-slate-800 hover:bg-gray-50 dark:hover:bg-slate-700 px-3 py-2 rounded-lg shadow-md border border-gray-300 dark:border-gray-700 transition-colors">
          <img id="desktopPreviewIcon" src="/assets/icons/eye.svg" alt="Preview Mode" class="h-4 w-4 dark:invert">
          <span class="text-sm font-medium text-gray-700 dark:text-gray-200">Preview</span>
        </button>
      </div>

      <!-- Mobile Toolbar (visible below md) -->
      <div class="md:hidden fixed bottom-16 left-0 right-0 z-40 bg-white dark:bg-slate-800 border-t border-gray-200 dark:border-slate-700 shadow-lg pb-[env(safe-area-inset-bottom)]">
        <div class="flex items-center justify-around py-1 px-4 relative">
          <!-- Settings Menu Button -->
          <button id="mobileSettingsBtn" class="flex flex-col items-center gap-1 py-1 px-2 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg transition-colors">
            <img src="/assets/icons/settings.svg" alt="Settings Menu" class="h-6 w-6 dark:invert">
            <span class="text-xs text-gray-600 dark:text-gray-300">Menu</span>
          </button>

          <!-- Size Options Button -->
          <button id="mobileSizeBtn" class="flex flex-col items-center gap-1 py-1 px-2 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg transition-colors">
            <img src="/assets/icons/size-opt.svg" alt="Size Options" class="h-6 w-6 dark:invert">
            <span class="text-xs text-gray-600 dark:text-gray-300">Size</span>
          </button>

          <!-- Preview Toggle Button -->
          <button id="mobilePreviewBtn" class="flex flex-col items-center gap-1 py-1 px-2 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg transition-colors">
            <img id="mobilePreviewIcon" src="/assets/icons/eye.svg" alt="Preview" class="h-6 w-6 dark:invert">
            <span class="text-xs text-gray-600 dark:text-gray-300">Preview</span>
          </button>

          <!-- Horizontal Icon Submenu (overlays toolbar) -->
          <div id="mobileSettingsSlideout" class="hidden absolute inset-0 bg-white dark:bg-slate-800 border-t border-gray-200 dark:border-slate-700 transition-transform duration-300 ease-in-out -translate-x-full">
            <div class="flex items-center justify-around h-full py-1 px-4">
              <!-- Back Button to return to main toolbar -->
              <button id="mobileSettingsBackBtn" class="flex flex-col items-center gap-1 py-1 px-2 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg transition-colors">
                <svg class="h-6 w-6 dark:invert" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
                </svg>
                <span class="text-xs text-gray-600 dark:text-gray-300">Back</span>
              </button>

              <!-- Storage Submenu Button -->
              <button id="mobileSaveSubmenuBtn" class="flex flex-col items-center gap-1 py-1 px-2 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg transition-colors">
                <img src="/assets/icons/save-menu.svg" alt="Storage" class="h-6 w-6 dark:invert">
                <span class="text-xs text-gray-600 dark:text-gray-300">Storage</span>
              </button>

              <!-- Export Submenu Button -->
              <button id="mobileExportSubmenuBtn" class="flex flex-col items-center gap-1 py-1 px-2 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg transition-colors">
                <img src="/assets/icons/export.svg" alt="Export" class="h-6 w-6 dark:invert">
                <span class="text-xs text-gray-600 dark:text-gray-300">Export</span>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Grids Container -->
      <div class="absolute inset-0 flex items-center justify-center overflow-hidden">
        <div class="builder-grids-wrapper relative transition-transform duration-200" style="transform-origin: center center;">
          <!-- 5x5 Serifs Grid -->
          <div id="serifsGrid" class="grid grid-cols-5 gap-0 z-10" style="width: 500px; height: 500px;">
            <!-- Grid cells will be generated by JavaScript -->
          </div>

          <!-- 4x4 Joins Grid (overlapped/inset) -->
          <div id="joinsGrid" class="absolute grid grid-cols-4 gap-0 z-0"
               style="width: 400px; height: 400px; top: 50px; left: 50px;">
            <!-- Grid cells will be generated by JavaScript -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Mobile Storage Submenu Modal -->
  <div id="mobileSaveMenu" class="hidden fixed inset-0 bottom-31 bg-black/50 z-50 md:hidden transition-opacity duration-200 border-b border-gray-200 dark:border-slate-700">
    <div class="absolute bottom-0 left-0 right-0 bg-white dark:bg-slate-800 rounded-t-2xl pb-[env(safe-area-inset-bottom)] border-t border-gray-200 dark:border-slate-700 transition-transform duration-150 ease-in-out translate-y-full max-h-[80vh] flex flex-col">
      <div class="p-4 border-b border-gray-200 dark:border-slate-700 flex-shrink-0">
        <div class="flex items-center justify-between text-gray-900 dark:text-gray-100">
          <h3 class="text-lg font-semibold">Storage</h3>
          <button id="closeSaveMenu" class="p-2 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg">
            <svg class="h-5 w-5" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
            </svg>
          </button>
        </div>
      </div>
      <div class="p-4 space-y-2 overflow-y-auto flex-1">
        <button onclick="saveComposition(); hideMobileSaveMenu()" class="w-full text-left px-4 py-3 bg-gray-50 dark:bg-slate-700 hover:bg-gray-100 dark:hover:bg-slate-600 rounded-lg transition-colors flex items-start space-x-3">
          <img src="/assets/icons/save.svg" alt="Save to browser" class="h-5 w-5 mt-0.5 dark:invert">
          <div>
            <div class="font-medium text-gray-900 dark:text-gray-100">Save to browser</div>
            <div class="text-sm text-gray-600 dark:text-gray-400">Save your work locally</div>
          </div>
        </button>
        <button onclick="saveCompositionToComputer(); hideMobileSaveMenu()" class="w-full text-left px-4 py-3 bg-gray-50 dark:bg-slate-700 hover:bg-gray-100 dark:hover:bg-slate-600 rounded-lg transition-colors flex items-start space-x-3">
          <img src="/assets/icons/save-computer.svg" alt="Save to computer" class="h-5 w-5 mt-0.5 dark:invert">
          <div>
            <div class="font-medium text-gray-900 dark:text-gray-100">Save to computer</div>
            <div class="text-sm text-gray-600 dark:text-gray-400">Download as JSON file</div>
          </div>
        </button>
        <button onclick="loadFromBrowser(); hideMobileSaveMenu()" class="w-full text-left px-4 py-3 bg-gray-50 dark:bg-slate-700 hover:bg-gray-100 dark:hover:bg-slate-600 rounded-lg transition-colors flex items-start space-x-3">
          <img src="/assets/icons/load.svg" alt="Load from browser" class="h-5 w-5 mt-0.5 dark:invert">
          <div>
            <div class="font-medium text-gray-900 dark:text-gray-100">Load from browser</div>
            <div class="text-sm text-gray-600 dark:text-gray-400">Load saved work</div>
          </div>
        </button>
        <button onclick="loadComposition(); hideMobileSaveMenu()" class="w-full text-left px-4 py-3 bg-gray-50 dark:bg-slate-700 hover:bg-gray-100 dark:hover:bg-slate-600 rounded-lg transition-colors flex items-start space-x-3">
          <img src="/assets/icons/load-computer.svg" alt="Load from computer" class="h-5 w-5 mt-0.5 dark:invert">
          <div>
            <div class="font-medium text-gray-900 dark:text-gray-100">Load from computer</div>
            <div class="text-sm text-gray-600 dark:text-gray-400">Upload JSON file</div>
          </div>
        </button>
        <button onclick="manageCompositions(); hideMobileSaveMenu()" class="w-full text-left px-4 py-3 bg-gray-50 dark:bg-slate-700 hover:bg-gray-100 dark:hover:bg-slate-600 rounded-lg transition-colors flex items-start space-x-3">
          <img src="/assets/icons/manage.svg" alt="Manage" class="h-5 w-5 mt-0.5 dark:invert">
          <div>
            <div class="font-medium text-gray-900 dark:text-gray-100">Manage</div>
            <div class="text-sm text-gray-600 dark:text-gray-400">Manage saved compositions</div>
          </div>
        </button>
        <button onclick="clearAllGrids(); hideMobileSaveMenu()" class="w-full text-left px-4 py-3 bg-red-50 dark:bg-red-900 hover:bg-red-100 dark:hover:bg-red-800 rounded-lg transition-colors flex items-start space-x-3">
          <img src="/assets/icons/clear.svg" alt="Clear All" class="h-5 w-5 mt-0.5 invert-0 dark:invert">
          <div>
            <div class="font-medium text-red-900 dark:text-red-100">Clear All</div>
            <div class="text-sm text-red-600 dark:text-red-400">Remove all shapes from grids</div>
          </div>
        </button>
      </div>
    </div>
  </div>

  <!-- Mobile Export Submenu Modal -->
  <div id="mobileExportMenu" class="hidden fixed inset-0 bottom-31 bg-black/50 z-50 md:hidden transition-opacity duration-200 border-b border-gray-200 dark:border-slate-700">
    <div class="absolute bottom-0 left-0 right-0 bg-white dark:bg-slate-800 rounded-t-2xl pb-[env(safe-area-inset-bottom)] border-t border-gray-200 dark:border-slate-700 transition-transform duration-150 ease-in-out translate-y-full max-h-[80vh] flex flex-col">
      <div class="p-4 border-b border-gray-200 dark:border-slate-700 flex-shrink-0">
        <div class="flex items-center justify-between text-gray-900 dark:text-gray-100">
          <h3 class="text-lg font-semibold">Export</h3>
          <button id="closeExportMenu" class="p-2 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg">
            <svg class="h-5 w-5" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
            </svg>
          </button>
        </div>
      </div>
      <div class="p-4 space-y-2 overflow-y-auto flex-1">
        <button onclick="exportAsPNG(); hideMobileExportMenu()" class="w-full text-left px-4 py-3 bg-gray-50 dark:bg-slate-700 hover:bg-gray-100 dark:hover:bg-slate-600 rounded-lg transition-colors flex items-start space-x-3">
          <img src="/assets/icons/png.svg" alt="Export PNG" class="h-5 w-5 mt-0.5 dark:invert">
          <div>
            <div class="font-medium text-gray-900 dark:text-gray-100">Export as PNG</div>
            <div class="text-sm text-gray-600 dark:text-gray-400">Transparent background</div>
          </div>
        </button>
        <button onclick="exportAsJPEG(); hideMobileExportMenu()" class="w-full text-left px-4 py-3 bg-gray-50 dark:bg-slate-700 hover:bg-gray-100 dark:hover:bg-slate-600 rounded-lg transition-colors flex items-start space-x-3">
          <img src="/assets/icons/image.svg" alt="Export JPEG" class="h-5 w-5 mt-0.5 dark:invert">
          <div>
            <div class="font-medium text-gray-900 dark:text-gray-100">Export as JPEG</div>
            <div class="text-sm text-gray-600 dark:text-gray-400">With current theme colors</div>
          </div>
        </button>
        <button onclick="exportAsSVG(); hideMobileExportMenu()" class="w-full text-left px-4 py-3 bg-gray-50 dark:bg-slate-700 hover:bg-gray-100 dark:hover:bg-slate-600 rounded-lg transition-colors flex items-start space-x-3">
          <img src="/assets/icons/vector.svg" alt="Export SVG" class="h-5 w-5 mt-0.5 dark:invert">
          <div>
            <div class="font-medium text-gray-900 dark:text-gray-100">Export as SVG</div>
            <div class="text-sm text-gray-600 dark:text-gray-400">Download as vector file</div>
          </div>
        </button>
      </div>
    </div>
  </div>

  <!-- Mobile Size Menu Modal -->
  <div id="mobileSizeMenu" class="hidden fixed inset-0 bottom-31 bg-black/50 z-50 md:hidden transition-opacity duration-200 border-b border-gray-200 dark:border-slate-700">
    <div class="absolute bottom-0 left-0 right-0 bg-white dark:bg-slate-800 rounded-t-2xl pb-[env(safe-area-inset-bottom)] border-t border-gray-200 dark:border-slate-700 transition-transform duration-150 ease-in-out translate-y-full">
      <div class="p-4 border-b border-gray-200 dark:border-slate-700">
        <div class="flex items-center justify-between text-gray-900 dark:text-gray-100">
          <h3 class="text-lg font-semibold">Grid Size</h3>
          <button id="closeSizeMenu" class="p-2 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg">
            <svg class="h-5 w-5" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
            </svg>
          </button>
        </div>
      </div>
      <div id="mobileSizeButtons" class="p-4 grid grid-cols-3 gap-2">
        <!-- Size buttons will be generated by JavaScript -->
      </div>
    </div>
  </div>

  <script type="module" src="/src/svg.js"></script>
  <script type="module" src="/src/mobile_builder.js"></script>
  <script type="module" src="/src/builder.js"></script>
  <script type="module" src="/src/storage.js"></script>
  <script type="module" src="/src/export.js"></script>
  <script type="module" src="/src/tutorial.js"></script>

  <!-- Mobile Settings Menu Script -->
  <script>
    // Mobile Settings Slideout Menu
    document.addEventListener('DOMContentLoaded', () => {
      const settingsBtn = document.getElementById('mobileSettingsBtn');
      const settingsSlideout = document.getElementById('mobileSettingsSlideout');
      const settingsBackBtn = document.getElementById('mobileSettingsBackBtn');
      const saveSubmenuBtn = document.getElementById('mobileSaveSubmenuBtn');
      const exportSubmenuBtn = document.getElementById('mobileExportSubmenuBtn');
      const saveMenu = document.getElementById('mobileSaveMenu');
      const exportMenu = document.getElementById('mobileExportMenu');
      const closeSaveMenu = document.getElementById('closeSaveMenu');
      const closeExportMenu = document.getElementById('closeExportMenu');

      let isSlideoutOpen = false;

      // Function to close slideout
      const closeSlideout = () => {
        isSlideoutOpen = false;
        settingsSlideout.classList.remove('translate-x-0');
        settingsSlideout.classList.add('-translate-x-full');
        setTimeout(() => {
          settingsSlideout.classList.add('hidden');
        }, 300);
      };

      // Function to open slideout
      const openSlideout = () => {
        isSlideoutOpen = true;
        settingsSlideout.classList.remove('hidden');
        requestAnimationFrame(() => {
          settingsSlideout.classList.remove('-translate-x-full');
          settingsSlideout.classList.add('translate-x-0');
        });
      };

      // Toggle settings slideout
      if (settingsBtn && settingsSlideout) {
        settingsBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          if (isSlideoutOpen) {
            closeSlideout();
          } else {
            openSlideout();
          }
        });
      }

      // Back button closes slideout
      if (settingsBackBtn) {
        settingsBackBtn.addEventListener('click', () => {
          closeSlideout();
        });
      }

      // Open Storage submenu
      if (saveSubmenuBtn && saveMenu) {
        saveSubmenuBtn.addEventListener('click', () => {
          // Close slideout
          closeSlideout();

          // Open storage modal after a brief delay
          setTimeout(() => {
            saveMenu.classList.remove('hidden');
            const modalContent = saveMenu.querySelector('.absolute');
            requestAnimationFrame(() => {
              requestAnimationFrame(() => {
                modalContent.classList.remove('translate-y-full');
                modalContent.classList.add('translate-y-0');
              });
            });
          }, 100);
        });
      }

      // Open Export submenu
      if (exportSubmenuBtn && exportMenu) {
        exportSubmenuBtn.addEventListener('click', () => {
          // Close slideout
          closeSlideout();

          // Open export modal after a brief delay
          setTimeout(() => {
            exportMenu.classList.remove('hidden');
            const modalContent = exportMenu.querySelector('.absolute');
            requestAnimationFrame(() => {
              requestAnimationFrame(() => {
                modalContent.classList.remove('translate-y-full');
                modalContent.classList.add('translate-y-0');
              });
            });
          }, 100);
        });
      }

      // Close Storage menu
      if (closeSaveMenu) {
        closeSaveMenu.addEventListener('click', () => {
          const modalContent = saveMenu.querySelector('.absolute');
          saveMenu.classList.add('opacity-0');
          modalContent.classList.remove('translate-y-0');
          modalContent.classList.add('translate-y-full');
          setTimeout(() => {
            saveMenu.classList.add('hidden');
            saveMenu.classList.remove('opacity-0');
          }, 150);
        });
      }

      // Close Export menu
      if (closeExportMenu) {
        closeExportMenu.addEventListener('click', () => {
          const modalContent = exportMenu.querySelector('.absolute');
          exportMenu.classList.add('opacity-0');
          modalContent.classList.remove('translate-y-0');
          modalContent.classList.add('translate-y-full');
          setTimeout(() => {
            exportMenu.classList.add('hidden');
            exportMenu.classList.remove('opacity-0');
          }, 150);
        });
      }

      // Close modals when clicking on backdrop
      [saveMenu, exportMenu].forEach(modal => {
        if (modal) {
          modal.addEventListener('click', (e) => {
            if (e.target === modal) {
              const modalContent = modal.querySelector('.absolute');
              modal.classList.add('opacity-0');
              modalContent.classList.remove('translate-y-0');
              modalContent.classList.add('translate-y-full');
              setTimeout(() => {
                modal.classList.add('hidden');
                modal.classList.remove('opacity-0');
              }, 150);
            }
          });
        }
      });
    });

    // Helper functions for closing menus
    window.hideMobileExportMenu = function() {
      const exportMenu = document.getElementById('mobileExportMenu');
      const modalContent = exportMenu?.querySelector('.absolute');
      if (exportMenu && modalContent) {
        exportMenu.classList.add('opacity-0');
        modalContent.classList.remove('translate-y-0');
        modalContent.classList.add('translate-y-full');
        setTimeout(() => {
          exportMenu.classList.add('hidden');
          exportMenu.classList.remove('opacity-0');
        }, 150);
      }
    };
  </script>

  <!-- Nav and Footer components -->
  <script type="module">
    import { initNav, initFooter } from '/src/components.js';
    import { initTutorial } from '/src/tutorial.js';

    initNav();
    // Footer not rendered on freebuilder page
    // initFooter();

    // Initialize tutorial after UI is ready
    setTimeout(() => {
      initTutorial();
    }, 1000);
  </script>
</body>
</html>
